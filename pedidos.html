<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Painel de Pedidos</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 10px;
      background: #f9f9f9;
    }
    .pedido {
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      margin-bottom: 15px;
      padding: 15px;
    }
    .pedido pre {
      white-space: pre-wrap;
      font-size: 15px;
    }
    .botoes {
      margin-top: 10px;
    }
    .botoes button {
      margin-right: 10px;
      padding: 5px 10px;
      font-size: 14px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<h2>ğŸ“¦ Painel de Pedidos</h2>
<div id="lista-pedidos"></div>

<script>
  const URL_PLANILHA = "https://opensheet.elk.sh/1_KqTCa8u1G49hRs3Vzf-SfU_uGLSYXlK1sAJHMqR_Ic/Pedidos"; // coloque o ID real aqui

  function carregarPedidos() {
    fetch(URL_PLANILHA)
      .then(res => res.json())
      .then(pedidos => {
        const container = document.getElementById("lista-pedidos");
        container.innerHTML = "";

        pedidos.reverse().forEach(pedido => {
          const div = document.createElement("div");
          div.className = "pedido";

          const mensagem = formatarMensagem(pedido);

          div.innerHTML = `
            <pre>${mensagem}</pre>
            <div class="botoes">
              <button onclick="imprimirTexto(\`${mensagem.replace(/`/g, "\\`")}\`)">ğŸ–¨ï¸ Imprimir</button>
            </div>
          `;
          container.appendChild(div);
        });
      });
  }

  function formatarMensagem(p) {
    const entregaOuRetirada = p.entrega === "Retirada"
      ? "ğŸ›ï¸ *RETIRADA NO LOCAL*"
      : `ğŸšš *ENTREGA*\nğŸ“ *EndereÃ§o:* ${p.endereco}, NÂº ${p.numero}, ${p.bairro}\nğŸ“ *Contato:* ${p.telefone}`;

    return `ğŸ‘‹ *NOVO PEDIDO*\n\n${entregaOuRetirada}\n\nğŸ“¦ *Itens:* ${p.itens}\nğŸ’° *Total:* R$ ${p.total}\n\nğŸ‘¤ *Nome:* ${p.nome}\nğŸ“… *Data:* ${p.data}\nğŸ•’ *HorÃ¡rio:* ${p.horario}`;
  }

  function imprimirTexto(texto) {
    const printWindow = window.open('', '_blank', 'width=600,height=600');
    printWindow.document.write(`<pre>${texto}</pre>`);
    printWindow.document.close();
    printWindow.focus();
    printWindow.print();
    printWindow.close();
  }

  carregarPedidos();
</script>

</body>
</html>
